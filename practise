<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuickCV | Next-Gen AI Enterprise Solutions</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://js.paystack.co/v1/inline.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap');
        
        :root {
            --primary: #3b82f6;
            --secondary: #8b5cf6;
            --bg-dark: #070b14;
        }

        body {
            background-color: var(--bg-dark);
            font-family: 'Plus Jakarta Sans', sans-serif;
            color: #f8fafc;
            overflow-x: hidden;
        }

        /* DECORATION PRESERVED */
        .ai-aura {
            position: fixed;
            width: 600px;
            height: 600px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.08) 0%, rgba(139, 92, 246, 0.03) 50%, transparent 100%);
            filter: blur(100px);
            z-index: -1;
            animation: drift 25s infinite alternate ease-in-out;
        }
        @keyframes drift {
            from { transform: translate(-10%, -10%); }
            to { transform: translate(30%, 20%); }
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .premium-gradient {
            background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%);
        }

        .cv-preview { 
            transition: all 0.5s cubic-bezier(0.2, 0.8, 0.2, 1);
        }
        .cv-preview:hover { 
            transform: translateY(-10px); 
            border-color: rgba(59, 130, 246, 0.4);
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.7);
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="antialiased">

    <div class="ai-aura top-0 left-0"></div>
    <div class="ai-aura bottom-0 right-0" style="animation-delay: -10s;"></div>

    <nav class="bg-slate-950/50 backdrop-blur-xl border-b border-white/5 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-6 h-16 flex justify-between items-center">
            <div class="text-2xl font-black tracking-tighter flex items-center gap-2">
                <div class="w-8 h-8 premium-gradient rounded-lg flex items-center justify-center text-white text-xs">Q</div>
                Quick<span class="text-blue-500">CV</span>
            </div>
            
            <div class="flex items-center gap-6">
                <a href="legal.html" class="flex items-center gap-2 px-3 py-1.5 text-slate-400 hover:text-white transition-all rounded-lg hover:bg-white/5">
                    <i class="fas fa-shield-halved text-xs"></i>
                    <span class="text-[9px] font-bold uppercase tracking-widest">Help & Legal</span>
                </a>       
                <button id="authBtn" onclick="window.openAuthModal()" class="text-[9px] font-black uppercase tracking-[0.2em] text-blue-400 hover:text-blue-300 transition">
                    Access Login
                </button>
                <div id="premiumBadge" class="hidden items-center px-4 py-1.5 premium-gradient rounded-full text-[9px] font-black text-white uppercase tracking-[0.2em]">
                    PRO MEMBER
                </div>
            </div>
        </div>
        
        <div class="bg-black/80 text-white py-2.5 px-6 text-[10px] font-bold flex justify-center gap-8 overflow-x-auto no-scrollbar border-b border-white/5">
            <span class="text-blue-500 uppercase tracking-widest border-r border-white/10 pr-6 flex items-center">
                <i class="fas fa-rocket mr-2"></i> Career Hub
            </span>
            <a href="YOUR_INDEED_LINK" target="_blank" class="hover:text-blue-400 transition flex items-center gap-1.5"><i class="fas fa-search text-blue-400"></i> BROWSE JOBS</a>
            <a href="YOUR_ADZUNA_LINK" target="_blank" class="hover:text-green-400 transition flex items-center gap-1.5 relative">
                <i class="fas fa-upload text-green-400"></i> UPLOAD CV 
                <span class="absolute -top-3 -right-4 bg-red-600 text-[7px] px-1 rounded animate-pulse">HOT</span>
            </a>
            <a href="YOUR_IMPACT_LINK" target="_blank" class="hover:text-purple-400 transition flex items-center gap-1.5"><i class="fas fa-certificate text-purple-400"></i> TOP SKILLS</a>
            <a href="YOUR_OFFERFORGE_LINK" target="_blank" class="hover:text-amber-400 transition flex items-center gap-1.5 text-amber-400"><i class="fas fa-map-marker-alt"></i> SA VACANCIES</a>
            <a href="YOUR_FINANCE_LINK" target="_blank" class="hover:text-red-400 transition flex items-center gap-1.5"><i class="fas fa-wallet text-red-400"></i> WORK COVER</a>
        </div>
    </nav>

    <div id="authModal" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4 bg-slate-950/90 backdrop-blur-md">
        <div class="glass-panel w-full max-w-md rounded-[2.5rem] p-10 relative border border-white/10">
            <button onclick="window.closeAuthModal()" class="absolute top-8 right-8 text-slate-500 hover:text-white"><i class="fas fa-times"></i></button>
            <div id="phoneStep">
                <h3 class="text-2xl font-bold mb-2">Secure Access</h3>
                <p class="text-slate-400 text-sm mb-8 leading-relaxed">Enter your phone number to receive a secure login code.</p>
                <input type="tel" id="userPhone" placeholder="+27 71 234 5678" class="w-full p-4 bg-white/5 rounded-2xl border border-white/10 mb-4 outline-none focus:border-blue-500 transition text-white">
                <div id="recaptcha-container"></div>
                <button onclick="window.sendOTP()" class="w-full premium-gradient text-white p-4 rounded-2xl font-bold uppercase tracking-widest text-xs mt-2">Send SMS Code</button>
            </div>
            <div id="otpStep" class="hidden">
                <h3 class="text-2xl font-bold mb-2">Verify Code</h3>
                <p class="text-slate-400 text-sm mb-8 leading-relaxed">Enter the 6-digit code sent to your phone.</p>
                <input type="number" id="otpCode" placeholder="123456" class="w-full p-4 bg-white/5 rounded-2xl border border-white/10 mb-6 outline-none focus:border-blue-500 transition text-white text-center text-xl tracking-[0.5em]">
                <button onclick="window.verifyOTP()" class="w-full premium-gradient text-white p-4 rounded-2xl font-bold uppercase tracking-widest text-xs">Login</button>
            </div>
        </div>
    </div>

    <main class="max-w-6xl mx-auto p-8 pt-12">
        <div id="statusBanner" class="mb-12 hidden">
            <div class="premium-gradient p-8 rounded-[2.5rem] text-white shadow-2xl flex flex-col md:flex-row justify-between items-center gap-6">
                <div>
                    <h3 class="text-2xl font-black">Unlimited Access Active</h3>
                    <p id="expiryText" class="text-blue-100 text-sm mt-1 opacity-80 uppercase tracking-wider font-bold"></p>
                </div>
                <button id="launchBtn" class="bg-white text-blue-600 px-10 py-4 rounded-2xl font-black text-xs tracking-widest uppercase hover:scale-105 transition-transform shadow-xl">Launch AI Editor</button>
            </div>
        </div>

        <section class="mb-20">
            <h2 class="text-slate-500 uppercase text-[10px] font-black tracking-[0.4em] mb-10 text-center">Executive Design Templates</h2>
            <div class="flex flex-wrap justify-center gap-10">
                <div class="cv-preview glass-panel p-3 rounded-[2rem] w-full max-w-[240px] border border-white/5">
                    <a href="cv.png" target="_blank">
                        <div class="aspect-[1/1.4] bg-slate-900 rounded-[1.5rem] overflow-hidden cursor-pointer">
                            <img src="cv.png" alt="CV" class="w-full h-full object-cover opacity-80 hover:opacity-100 transition">
                        </div>
                    </a>
                </div>
                <div class="cv-preview glass-panel p-3 rounded-[2rem] w-full max-w-[240px] border border-white/5">
                    <a href="coverletter.png" target="_blank">
                        <div class="aspect-[1/1.4] bg-slate-900 rounded-[1.5rem] overflow-hidden cursor-pointer">
                            <img src="coverletter.png" alt="Cover Letter" class="w-full h-full object-cover opacity-80 hover:opacity-100 transition">
                        </div>
                    </a>
                </div>
            </div>
        </section>

        <div id="billingGrid" class="max-w-5xl mx-auto grid md:grid-cols-2 gap-10">
            <div class="glass-panel p-10 rounded-[2.5rem] flex flex-col justify-between border-t-4 border-slate-800">
                <div>
                    <h3 class="text-xl font-black mb-2 tracking-tight">24h Express</h3>
                    <p class="text-slate-500 text-sm mb-8 leading-relaxed">Perfect for a single urgent application.</p>
                </div>
                <button onclick="window.startPurchaseFlow('24h')" class="w-full flex justify-between items-center p-5 bg-white/5 rounded-2xl hover:bg-white/10 transition-all font-bold">
                    <span class="uppercase tracking-widest text-[10px]">Get 1 Day</span>
                    <span class="text-blue-400">R10</span>
                </button>
            </div>

            <div class="premium-gradient p-[1.5px] rounded-[2.5rem] shadow-2xl">
                <div class="bg-slate-950/90 h-full w-full rounded-[2.5rem] p-10 pt-12 flex flex-col justify-between relative">
                    <div class="absolute top-4 left-10 bg-blue-600 text-white px-4 py-1.5 rounded-full text-[9px] font-black uppercase tracking-widest">Most Recommended</div>
                    <h3 class="text-xl font-black mb-2 tracking-tight mt-4">Professional Pass</h3>
                    <button onclick="window.startPurchaseFlow('30d')" class="w-full flex justify-between items-center p-5 premium-gradient rounded-2xl hover:opacity-90 transition font-black">
                        <span class="uppercase tracking-widest text-[10px]">Unlock Pro Now</span>
                        <span class="bg-white/20 px-3 py-1 rounded-lg">R50</span>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, setDoc, updateDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth, RecaptchaVerifier, signInWithPhoneNumber, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBcp0fkuwhOOyO7fgAlbCoftWwkuog-vwQ",
            authDomain: "quickcv-47c99.firebaseapp.com",
            projectId: "quickcv-47c99",
            storageBucket: "quickcv-47c99.firebasestorage.app",
            messagingSenderId: "541347686112",
            appId: "1:541347686112:web:b821dd7213ab8674959285"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        // CONFIG & PRICING
        const PLAN_CONFIG = {
            '24h': { amount: 1000, days: 1, target: 'ten.html' },
            '30d': { amount: 5000, days: 30, target: 'fifty.html' }
        };

        let currentUser = null;
        let pendingPlanKey = null; 
        let confirmationResult = null;

        window.openAuthModal = () => document.getElementById('authModal').classList.remove('hidden');
        window.closeAuthModal = () => {
            document.getElementById('authModal').classList.add('hidden');
            pendingPlanKey = null; // Clear intent on close
        };

        window.sendOTP = async () => {
            const phone = document.getElementById('userPhone').value;
            if (!phone) return alert("Enter phone");
            window.recaptchaVerifier = new RecaptchaVerifier(auth, 'recaptcha-container', { 'size': 'invisible' });
            try {
                confirmationResult = await signInWithPhoneNumber(auth, phone, window.recaptchaVerifier);
                document.getElementById('phoneStep').classList.add('hidden');
                document.getElementById('otpStep').classList.remove('hidden');
            } catch (e) { alert(e.message); }
        };

        window.verifyOTP = async () => {
            try {
                const result = await confirmationResult.confirm(document.getElementById('otpCode').value);
                // Auth change listener below will handle the rest
            } catch (e) { alert("Wrong code"); }
        };

        // AUTH & DATA FLOW (Fixed Architecture)
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                currentUser = user;
                document.getElementById('authBtn').classList.add('hidden');
                
                const userRef = doc(db, "users", user.uid);
                const docSnap = await getDoc(userRef); // getDoc instead of onSnapshot

                let userData;
                if (!docSnap.exists()) {
                    userData = { phone: user.phoneNumber, expiryTime: 0, planType: 'none' };
                    await setDoc(userRef, userData);
                } else {
                    userData = docSnap.data();
                }

                renderUI(userData);
                closeAuthModal();

                if (pendingPlanKey) {
                    processPayment(pendingPlanKey);
                    pendingPlanKey = null;
                }
            }
        });

        function renderUI(data) {
            const isPremium = Date.now() < (data.expiryTime || 0);
            document.getElementById('statusBanner').classList.toggle('hidden', !isPremium);
            document.getElementById('billingGrid').classList.toggle('hidden', isPremium);
            document.getElementById('premiumBadge').classList.toggle('hidden', !isPremium);

            if (isPremium) {
                document.getElementById('expiryText').innerText = `Active until: ${new Date(data.expiryTime).toLocaleDateString()}`;
                document.getElementById('launchBtn').onclick = () => {
                    window.location.href = PLAN_CONFIG[data.planType]?.target || 'ten.html';
                };
            }
        }

        window.startPurchaseFlow = (planKey) => {
            if (!currentUser) {
                pendingPlanKey = planKey;
                openAuthModal();
            } else {
                processPayment(planKey);
            }
        };

        function processPayment(planKey) {
            const config = PLAN_CONFIG[planKey];
            const handler = PaystackPop.setup({
                key: 'pk_test_421d171989e8c850ae50df23425b607cae9fe366',
                email: currentUser.phoneNumber.replace(/\D/g, '') + "@quickcv.com",
                amount: config.amount,
                currency: 'ZAR',
                callback: async (res) => {
                    const newExpiry = Date.now() + (config.days * 24 * 60 * 60 * 1000);
                    await updateDoc(doc(db, "users", currentUser.uid), {
                        expiryTime: newExpiry,
                        planType: planKey,
                        lastTx: res.reference
                    });
                    window.location.replace(config.target);
                }
            });
            handler.openIframe();
        }
    </script>
</body>
</html>






<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuickCV | Next-Gen AI Enterprise Solutions</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://js.paystack.co/v1/inline.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap');
        
        :root {
            --primary: #3b82f6;
            --secondary: #8b5cf6;
            --bg-dark: #070b14;
        }

        body {
            background-color: var(--bg-dark);
            font-family: 'Plus Jakarta Sans', sans-serif;
            color: #f8fafc;
            overflow-x: hidden;
        }

        /* DECORATION PRESERVED */
        .ai-aura {
            position: fixed;
            width: 600px;
            height: 600px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(59, 130, 246, 0.08) 0%, rgba(139, 92, 246, 0.03) 50%, transparent 100%);
            filter: blur(100px);
            z-index: -1;
            animation: drift 25s infinite alternate ease-in-out;
        }
        @keyframes drift {
            from { transform: translate(-10%, -10%); }
            to { transform: translate(30%, 20%); }
        }

        .glass-panel {
            background: rgba(15, 23, 42, 0.6);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .premium-gradient {
            background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%);
        }

        .cv-preview { 
            transition: all 0.5s cubic-bezier(0.2, 0.8, 0.2, 1);
        }
        .cv-preview:hover { 
            transform: translateY(-10px); 
            border-color: rgba(59, 130, 246, 0.4);
            box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.7);
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="antialiased">

    <div class="ai-aura top-0 left-0"></div>
    <div class="ai-aura bottom-0 right-0" style="animation-delay: -10s;"></div>

    <nav class="bg-slate-950/50 backdrop-blur-xl border-b border-white/5 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-6 h-16 flex justify-between items-center">
            <div class="text-2xl font-black tracking-tighter flex items-center gap-2">
                <div class="w-8 h-8 premium-gradient rounded-lg flex items-center justify-center text-white text-xs">Q</div>
                Quick<span class="text-blue-500">CV</span>
            </div>
            
            <div class="flex items-center gap-6">
                <a href="legal.html" class="flex items-center gap-2 px-3 py-1.5 text-slate-400 hover:text-white transition-all rounded-lg hover:bg-white/5">
                    <i class="fas fa-shield-halved text-xs"></i>
                    <span class="text-[9px] font-bold uppercase tracking-widest">Help & Legal</span>
                </a>       
                <button id="authBtn" onclick="window.openAuthModal()" class="text-[9px] font-black uppercase tracking-[0.2em] text-blue-400 hover:text-blue-300 transition">
                    Access Login
                </button>
                <div id="premiumBadge" class="hidden items-center px-4 py-1.5 premium-gradient rounded-full text-[9px] font-black text-white uppercase tracking-[0.2em]">
                    PRO MEMBER
                </div>
            </div>
        </div>
        
        <div class="bg-black/80 text-white py-2.5 px-6 text-[10px] font-bold flex justify-center gap-8 overflow-x-auto no-scrollbar border-b border-white/5">
            <span class="text-blue-500 uppercase tracking-widest border-r border-white/10 pr-6 flex items-center">
                <i class="fas fa-rocket mr-2"></i> Career Hub
            </span>
            <a href="YOUR_INDEED_LINK" target="_blank" class="hover:text-blue-400 transition flex items-center gap-1.5"><i class="fas fa-search text-blue-400"></i> BROWSE JOBS</a>
            <a href="YOUR_ADZUNA_LINK" target="_blank" class="hover:text-green-400 transition flex items-center gap-1.5 relative">
                <i class="fas fa-upload text-green-400"></i> UPLOAD CV 
                <span class="absolute -top-3 -right-4 bg-red-600 text-[7px] px-1 rounded animate-pulse">HOT</span>
            </a>
            <a href="YOUR_IMPACT_LINK" target="_blank" class="hover:text-purple-400 transition flex items-center gap-1.5"><i class="fas fa-certificate text-purple-400"></i> TOP SKILLS</a>
            <a href="YOUR_OFFERFORGE_LINK" target="_blank" class="hover:text-amber-400 transition flex items-center gap-1.5 text-amber-400"><i class="fas fa-map-marker-alt"></i> SA VACANCIES</a>
            <a href="YOUR_FINANCE_LINK" target="_blank" class="hover:text-red-400 transition flex items-center gap-1.5"><i class="fas fa-wallet text-red-400"></i> WORK COVER</a>
        </div>
    </nav>

    <div id="authModal" class="fixed inset-0 z-[100] hidden flex items-center justify-center p-4 bg-slate-950/90 backdrop-blur-md">
        <div class="glass-panel w-full max-w-md rounded-[2.5rem] p-10 relative border border-white/10">
            <button onclick="window.closeAuthModal()" class="absolute top-8 right-8 text-slate-500 hover:text-white"><i class="fas fa-times"></i></button>
            
            <div id="phoneStep">
                <h3 class="text-2xl font-bold mb-2">Secure Access</h3>
                <p class="text-slate-400 text-sm mb-8 leading-relaxed">Enter your phone number to receive a secure login code.</p>
                <input type="tel" id="userPhone" placeholder="+27 71 234 5678" class="w-full p-4 bg-white/5 rounded-2xl border border-white/10 mb-4 outline-none focus:border-blue-500 transition text-white">
                <div id="recaptcha-container"></div>
                <button onclick="window.sendOTP()" class="w-full premium-gradient text-white p-4 rounded-2xl font-bold uppercase tracking-widest text-xs mt-2">Send SMS Code</button>
            </div>

            <div id="otpStep" class="hidden">
                <h3 class="text-2xl font-bold mb-2">Verify Code</h3>
                <p class="text-slate-400 text-sm mb-8 leading-relaxed">Enter the 6-digit code sent to your phone.</p>
                <input type="number" id="otpCode" placeholder="123456" class="w-full p-4 bg-white/5 rounded-2xl border border-white/10 mb-6 outline-none focus:border-blue-500 transition text-white text-center text-xl tracking-[0.5em]">
                <button onclick="window.verifyOTP()" class="w-full premium-gradient text-white p-4 rounded-2xl font-bold uppercase tracking-widest text-xs">Login</button>
            </div>
        </div>
    </div>

    <main class="max-w-6xl mx-auto p-8 pt-12">
        <div id="statusBanner" class="mb-12 hidden">
            <div class="premium-gradient p-8 rounded-[2.5rem] text-white shadow-2xl flex flex-col md:flex-row justify-between items-center gap-6">
                <div>
                    <h3 class="text-2xl font-black">Unlimited Access Active</h3>
                    <p id="expiryText" class="text-blue-100 text-sm mt-1 opacity-80 uppercase tracking-wider font-bold"></p>
                </div>
                <button id="launchBtn" class="bg-white text-blue-600 px-10 py-4 rounded-2xl font-black text-xs tracking-widest uppercase hover:scale-105 transition-transform shadow-xl">Launch AI Editor</button>
            </div>
        </div>

        <section class="mb-20">
            <h2 class="text-slate-500 uppercase text-[10px] font-black tracking-[0.4em] mb-10 text-center">Executive Design Templates</h2>
            <div class="flex flex-wrap justify-center gap-10">
                <div class="cv-preview glass-panel p-3 rounded-[2rem] w-full max-w-[240px] border border-white/5">
                    <a href="cv.png" target="_blank">
                        <div class="aspect-[1/1.4] bg-slate-900 rounded-[1.5rem] overflow-hidden cursor-pointer">
                            <img src="cv.png" alt="CV" class="w-full h-full object-cover opacity-80 hover:opacity-100 transition">
                        </div>
                    </a>
                </div>
                <div class="cv-preview glass-panel p-3 rounded-[2rem] w-full max-w-[240px] border border-white/5">
                    <a href="coverletter.png" target="_blank">
                        <div class="aspect-[1/1.4] bg-slate-900 rounded-[1.5rem] overflow-hidden cursor-pointer">
                            <img src="coverletter.png" alt="Cover Letter" class="w-full h-full object-cover opacity-80 hover:opacity-100 transition">
                        </div>
                    </a>
                </div>
            </div>
        </section>

        <div id="billingGrid" class="max-w-5xl mx-auto grid md:grid-cols-2 gap-10">
            <div class="glass-panel p-10 rounded-[2.5rem] flex flex-col justify-between border-t-4 border-slate-800">
                <div>
                    <h3 class="text-xl font-black mb-2 tracking-tight">24h Express</h3>
                    <p class="text-slate-500 text-sm mb-8 leading-relaxed">Perfect for a single urgent application.</p>
                    <ul class="space-y-4 mb-10 text-xs font-bold text-slate-400">
                        <li class="flex items-center gap-3"><i class="fas fa-check text-blue-500"></i> 24h Unlimited Access</li>
                        <li class="flex items-center gap-3"><i class="fas fa-check text-blue-500"></i> Full AI editing tools</li>
                    </ul>
                </div>
                <button onclick="window.startPurchaseFlow('R10', 1)" class="w-full flex justify-between items-center p-5 bg-white/5 rounded-2xl hover:bg-white/10 transition-all font-bold">
                    <span class="uppercase tracking-widest text-[10px]">Get 1 Day</span>
                    <span class="text-blue-400">R10</span>
                </button>
            </div>

            <div class="premium-gradient p-[1.5px] rounded-[2.5rem] shadow-2xl shadow-blue-500/20">
                <div class="bg-slate-950/90 h-full w-full rounded-[2.5rem] p-10 pt-12 flex flex-col justify-between relative">
                    <div class="absolute top-4 left-10 bg-blue-600 text-white px-4 py-1.5 rounded-full text-[9px] font-black uppercase tracking-widest shadow-lg z-10">
                        Most Recommended
                    </div>
                    
                    <div>
                        <h3 class="text-xl font-black mb-2 tracking-tight mt-4">Professional Pass</h3>
                        <p class="text-slate-500 text-sm mb-8 leading-relaxed">Full career hunt protection for a month.</p>
                        <ul class="space-y-4 mb-10 text-xs font-bold text-slate-300">
                            <li class="flex items-center gap-3"><i class="fas fa-check text-blue-500"></i> 30 Days Unlimited Access</li>
                            <li class="flex items-center gap-3"><i class="fas fa-check text-blue-500"></i> Multiple Cover Letters</li>
                            <li class="flex items-center gap-3"><i class="fas fa-check text-blue-500"></i> Priority Cloud Support</li>
                        </ul>
                    </div>
                    
                    <button onclick="window.startPurchaseFlow('R50', 30)" class="w-full flex justify-between items-center p-5 premium-gradient rounded-2xl hover:opacity-90 transition font-black shadow-lg shadow-blue-900/40">
                        <span class="uppercase tracking-widest text-[10px]">Unlock Pro Now</span>
                        <span class="bg-white/20 px-3 py-1 rounded-lg">R50</span>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, setDoc, updateDoc, onSnapshot, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth, RecaptchaVerifier, signInWithPhoneNumber, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBcp0fkuwhOOyO7fgAlbCoftWwkuog-vwQ",
            authDomain: "quickcv-47c99.firebaseapp.com",
            projectId: "quickcv-47c99",
            storageBucket: "quickcv-47c99.firebasestorage.app",
            messagingSenderId: "541347686112",
            appId: "1:541347686112:web:b821dd7213ab8674959285"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        let currentUser = null;
        let pendingPlan = null;
        let confirmationResult = null;
        window.isRedirecting = false; 

        // NAVIGATION LOGIC
        window.openAuthModal = () => document.getElementById('authModal').classList.remove('hidden');
        window.closeAuthModal = () => {
            document.getElementById('authModal').classList.add('hidden');
            document.getElementById('phoneStep').classList.remove('hidden');
            document.getElementById('otpStep').classList.add('hidden');
        };

        // SMS AUTH LOGIC
        window.sendOTP = async () => {
            const phone = document.getElementById('userPhone').value;
            if (!phone || phone.length < 10) return alert("Please enter valid phone (+27)");
            
            if (!window.recaptchaVerifier) {
                window.recaptchaVerifier = new RecaptchaVerifier(auth, 'recaptcha-container', { 'size': 'invisible' });
            }

            try {
                confirmationResult = await signInWithPhoneNumber(auth, phone, window.recaptchaVerifier);
                document.getElementById('phoneStep').classList.add('hidden');
                document.getElementById('otpStep').classList.remove('hidden');
            } catch (error) {
                alert("SMS Error: " + error.message);
            }
        };

        window.verifyOTP = async () => {
            const code = document.getElementById('otpCode').value;
            try {
                const result = await confirmationResult.confirm(code);
                currentUser = result.user;
                closeAuthModal();
            } catch (error) {
                alert("Invalid code.");
            }
        };

        // CORE FUNNEL LOGIC (The "Fixes")
        onAuthStateChanged(auth, async (user) => {
            if (user) {
                currentUser = user;
                document.getElementById('authBtn').classList.add('hidden');
                
                // ARCHITECTURE FIX: Use UID as the single source of truth
                const userRef = doc(db, "users", user.uid); 
                
                onSnapshot(userRef, (docSnap) => {
                    if (window.isRedirecting) return;
                    
                    if (docSnap.exists()) {
                        const data = docSnap.data();
                        renderUI(data);
                        // If user logged in while trying to buy, continue payment
                        if(pendingPlan) {
                            processPayment(pendingPlan.plan, pendingPlan.days);
                            pendingPlan = null;
                        }
                    } else {
                        // Initialize new user
                        setDoc(userRef, { 
                            isPremium: false, 
                            phone: user.phoneNumber, 
                            createdAt: Date.now(),
                            planType: 'none'
                        });
                    }
                });
            }
        });

        function renderUI(data) {
            const now = Date.now();
            const isPremium = data.isPremium && now < data.expiryTime;
            
            const banner = document.getElementById('statusBanner');
            const grid = document.getElementById('billingGrid');
            const badge = document.getElementById('premiumBadge');
            const launchBtn = document.getElementById('launchBtn');

            if (isPremium) {
                grid.classList.add('hidden');
                banner.classList.remove('hidden');
                badge.classList.replace('hidden', 'flex');
                document.getElementById('expiryText').innerText = `Pro Access until: ${new Date(data.expiryTime).toLocaleDateString()}`;
                
                // LOGIC FIX: Use the planType stored in DB to decide where to go
                launchBtn.onclick = () => {
                    window.location.href = (data.planType === '30d') ? 'fifty.html' : 'ten.html';
                };
            } else {
                grid.classList.remove('hidden');
                banner.classList.add('hidden');
                badge.classList.replace('flex', 'hidden');
            }
        }

        window.startPurchaseFlow = (plan, days) => {
            pendingPlan = { plan, days };
            if (currentUser) processPayment(plan, days);
            else openAuthModal();
        };

        // SECURE PAYMENT CALLBACK
        const handlePaystackSuccess = async (response, days) => {
            window.isRedirecting = true; 
            const expiry = Date.now() + (days * 24 * 60 * 60 * 1000);
            const planCode = (days > 2) ? '30d' : '24h';
            
            try {
                // ARCHITECTURE FIX: Update by UID, store explicit Plan Type
                await updateDoc(doc(db, "users", currentUser.uid), {
                    isPremium: true,
                    expiryTime: expiry,
                    planType: planCode,
                    lastTx: response.reference,
                    updatedAt: Date.now()
                });
                
                const targetPage = (days <= 2) ? 'ten.html' : 'fifty.html';
                window.location.replace(targetPage); 
            } catch (e) {
                window.isRedirecting = false;
                alert("Activation Error. Please contact support.");
            }
        };

        window.processPayment = function(plan, days) {
            const amount = parseInt(plan.replace(/\D/g, '')) * 100;
            const virtualEmail = currentUser.phoneNumber.replace('+', '') + "@quickcv.com";
            
            const handler = PaystackPop.setup({
                key: 'pk_test_421d171989e8c850ae50df23425b607cae9fe366',
                email: virtualEmail,
                amount: amount,
                currency: 'ZAR',
                callback: (response) => handlePaystackSuccess(response, days),
                onClose: () => console.log("Window closed")
            });
            handler.openIframe();
        };
    </script>
</body>
</html>
needs these fixes
üî¥ MAJOR VIOLATIONS (CRITICAL)
‚ùå 1. You are still using onSnapshot on the user document

This breaks your funnel architecture

Where it happens:

onSnapshot(userRef, (docSnap) => {


Why this is wrong

onSnapshot is real-time

Any update (including your own updateDoc) retriggers UI logic

This causes:

Double redirects

Payment re-trigger risks

Race conditions

The window.isRedirecting hack (which should NOT exist)

Your own instruction violated:

‚ÄúThe moment payment hits, the user is snapped into the builder.‚Äù

Real-time listeners are the opposite of snapping ‚Äî they linger.

‚úÖ Correct rule

Auth ‚Üí getDoc() once

Render UI

Stop listening

‚ùå 2. You introduced window.isRedirecting

This is a code smell.

Where:

window.isRedirecting = false;
if (window.isRedirecting) return;


Why this is bad

This is a patch for a race condition YOU created

Production code should not need ‚Äúdon‚Äôt run twice‚Äù flags

If you need this ‚Üí architecture is wrong

‚úÖ Correct rule

Remove the cause (onSnapshot), not the symptom

‚ùå 3. You are mixing plan concepts (plan, days, planType)

You broke single source of truth.

Examples:

pendingPlan = { plan, days };
planCode = (days > 2) ? '30d' : '24h';
launchBtn.onclick = () => data.planType === '30d'


Why this is dangerous

A plan is a business concept

Days is a derived value

You are inferring instead of asserting

‚úÖ Correct rule
Store exactly one of:

plan: "24h" | "30d"
expiryTime: number


Never infer plan from days.

‚ùå 4. Payment amount is derived from UI text

This is a security and logic flaw.

Where:

const amount = parseInt(plan.replace(/\D/g, '')) * 100;


Why this is bad

UI text ‚â† business logic

If text changes ‚Üí payment breaks

Anyone can modify DOM text

‚úÖ Correct rule
Payment amount must be hard-mapped:

const PRICES = { "24h": 1000, "30d": 5000 };

‚ùå 5. User document creation happens inside a listener

Where:

onSnapshot(userRef, ...)
else {
  setDoc(userRef, { ... })
}


Why this is wrong

This can run multiple times

Can overwrite data in race scenarios

User creation should be one-time, not reactive

‚úÖ Correct rule
Create user once after auth if not exists.

üü° MEDIUM ISSUES (WON‚ÄôT BREAK BUT WILL HURT YOU)
‚ö†Ô∏è 6. pendingPlan survives auth state too loosely

If the user:

Opens modal

Closes it

Logs in later

Payment may still auto-trigger unexpectedly.

‚úÖ Fix: Clear pending intent on modal close.

‚ö†Ô∏è 7. Firestore fields are inconsistent

You use:

planType

isPremium

expiryTime

But isPremium is redundant.

‚úÖ Rule:
Premium = Date.now() < expiryTime

üü¢ WHAT YOU DID RIGHT (IMPORTANT)

You are not bad at this ‚Äî these were good decisions:

‚úÖ UID-based identity
‚úÖ Phone auth (no passwords)
‚úÖ Explicit expiry timestamp
‚úÖ Redirect after payment (not button click)
‚úÖ Clear separation between landing and builders
‚úÖ Strong UX funnel design

Your vision is solid ‚Äî the mistakes are architectural, not conceptual.

‚úÖ MINIMAL FIX SUMMARY (NO UI CHANGES)

If you only fix four things, your app becomes production-safe:

‚ùå Remove onSnapshot ‚Üí ‚úÖ use getDoc

‚ùå Remove window.isRedirecting

‚ùå Remove days inference ‚Üí ‚úÖ store plan

‚ùå Remove UI-derived pricing ‚Üí ‚úÖ hard-map prices





To understand your website as a whole, think of it as a "Premium Career Funnel." It‚Äôs not just a website; it‚Äôs an automated business that moves a user from a "job seeker" to a "premium candidate" through four distinct phases.
Here is the complete walkthrough of the user journey from start to finish:
Phase 1: The Hook (Landing Page)
When a user arrives at your domain, they see the Executive Portfolio:
 * Visual Trust: They see high-end previews of the CVs and Cover Letters. The "AI Aura" and glassmorphism design make the site feel expensive and modern.
 * The Adzuna/Indeed Integration: The top bar has "Hot" links to actual job sites. This establishes your site as a "Career Hub," not just a document maker.
 * The Choice: They are presented with two options: a 24-hour pass (R10) or a 30-day Professional Pass (R50).
Phase 2: The Secure Entry (Authentication)
When they click "Get Started" or "Unlock Pro":
 * OTP Login: A modal pops up asking for their phone number.
 * SMS Verification: They get a code via SMS (Firebase Auth). This is crucial because it links their payment to their phone number. They never have to remember a password.
 * User Check: The system checks your database: "Does +27... already have an active subscription?"
Phase 3: The Transaction (Paystack)
If the user isn't premium yet:
 * Payment Trigger: The Paystack window slides in natively.
 * Localized Payment: They pay via Card, EFT, or SnapScan in South African Rands.
 * The Switch: The moment the payment hits, your code updates their Firebase record with an expiryTime (e.g., current time + 30 days).
 * The Auto-Redirect: The user is "snapped" from the landing page directly into the builder (ten.html or fifty.html).
Phase 4: The Construction (The Builder)
Now the user is in the "Engine Room." This is where the magic happens:
 * Template Selection: They pick a "Structure."
   * Modern: Clean, corporate.
   * Tech Impact: Has the dark sidebar for skills and contact info.
   * Minimalist: Centered, elegant, high-end.
 * Live-Edit Editor: On the left side of the screen, they type their details. On the right side, the CV document updates instantly. They don't have to "Preview" ‚Äì they are looking at the final product as they type.
 * Data Sync: Their contact info (Email/Phone) is automatically pulled into the document to save them time.
Phase 5: The Delivery (Export)
Once they are happy with their CV:
 * PDF Generation: They hit "Download." The code takes a high-resolution "snapshot" of the HTML CV and converts it into a professional PDF file.
 * History Logging: The system saves a record of this CV generation to their profile in Firebase so they can come back to it later.
Phase 6: The "Upsell" (Cover Letter)
Immediately after the CV download:
 * Cover Letter Modal: A message asks: "CV Generated! Want a matching Cover Letter?"
 * Completion: This ensures the user feels they got "Full Service" for their R10 or R50.
Why this is a "Genius" Business Model:
 * Passive Income: You don't have to manually send CVs. The code does it while you sleep.
 * Low Friction: R10 is an "impulse buy." Most people won't think twice about paying R10 for a professional job application.
 * Clean Data: You are building a database of phone numbers of people currently looking for jobs‚Äîthis data is very valuable for future marketing.
What is missing right now?
To make this 10/10, you need the "Work History" and "Skills" sections. Currently, the code only handles the "Header" and "Summary."
Would you like me to provide the code to add the "Experience" section, where users can click a button to "Add Job" and list their previous companies?








rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    
    // We target the 'users' collection where the Document ID is the phone number
    match /users/{phoneId} {
      
      // ALLOW READ: Only if the person is logged in AND their token matches this document ID
      // ALLOW UPDATE: Same security check (prevents users from updating other people's premium status)
      allow read, update: if request.auth != null && request.auth.token.phone_number == phoneId;
      
      // ALLOW CREATE: Only if the person is logged in. 
      // This is used for the very first time they log in and don't have a document yet.
      allow create: if request.auth != null && request.auth.token.phone_number == phoneId;
      
      // ALLOW DELETE: Usually, we don't want users deleting their own profiles/history
      allow delete: if false; 
    }
  }
}


so first should be a page where they see a an example of how the cv and cover letter will look like and on the bottom of that should be those two box options 1. click here to get unlimted cvs and cover letters r5 for 1 day, r10 for 3 days r20 for 15 days, r30 30 days....2. click here to get watch to earn stars, whats at three ads to get get 3 stars and generate 1 cv and 1 cover letter and also bank star for future use. on the top right show me buttons that when clicked leads to those job offers, job site where user has to sign up and those kind of thing




give me full html codes for this(css+js+html in one html) it uses this // Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyBcp0fkuwhOOyO7fgAlbCoftWwkuog-vwQ",
  authDomain: "quickcv-47c99.firebaseapp.com",
  projectId: "quickcv-47c99",
  storageBucket: "quickcv-47c99.firebasestorage.app",
  messagingSenderId: "541347686112",
  appId: "1:541347686112:web:b821dd7213ab8674959285",
  measurementId: "G-NQ66199Z12"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);






<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuickCV | Premium Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://js.paystack.co/v1/inline.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background-color: #f3f4f6; font-family: 'Inter', sans-serif; }
        .cv-preview { box-shadow: 0 10px 25px rgba(0,0,0,0.1); transition: transform 0.3s ease; }
        .cv-preview:hover { transform: scale(1.02); }
        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); }
    </style>
</head>
<body>

    <nav class="bg-white border-b p-4 flex justify-between items-center sticky top-0 z-50">
        <div class="text-2xl font-bold text-blue-600">Quick<span class="text-gray-800">CV</span></div>
        <div class="flex space-x-4">
            <a href="https://indeed.com" target="_blank" class="flex items-center px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-semibold">
                <i class="fas fa-briefcase mr-2"></i> Job Offers
            </a>
            <a href="#" class="flex items-center px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-sm font-semibold">
                <i class="fas fa-graduation-cap mr-2"></i> Career Boost
            </a>
            <div class="flex items-center px-4 py-2 bg-yellow-100 border border-yellow-300 rounded-lg text-sm font-bold text-yellow-700">
                <i class="fas fa-star mr-2"></i> Stars: <span id="starCount" class="ml-1">0</span>
            </div>
        </div>
    </nav>

    <main class="max-w-5xl mx-auto p-6">
        
        <h2 class="text-center text-xl font-bold text-gray-700 mb-6">Preview Your Documents</h2>
        <div class="flex flex-col md:flex-row gap-6 mb-12 justify-center">
            <div class="cv-preview bg-white p-4 border rounded shadow-sm w-full md:w-64">
                <div class="h-80 bg-gray-200 rounded flex items-center justify-center text-gray-400">
                    <img src="https://via.placeholder.com/200x280?text=CV+Preview" alt="CV Preview">
                </div>
                <p class="text-center mt-2 font-bold text-sm">Professional CV</p>
            </div>
            <div class="cv-preview bg-white p-4 border rounded shadow-sm w-full md:w-64">
                <div class="h-80 bg-gray-200 rounded flex items-center justify-center text-gray-400">
                    <img src="https://via.placeholder.com/200x280?text=Cover+Letter+Preview" alt="CL Preview">
                </div>
                <p class="text-center mt-2 font-bold text-sm">Matching Cover Letter</p>
            </div>
        </div>

        <div class="grid md:grid-cols-2 gap-8">
            
            <div class="bg-white p-8 rounded-2xl shadow-lg border-2 border-blue-500 relative overflow-hidden">
                <div class="absolute top-0 right-0 bg-blue-500 text-white px-4 py-1 rounded-bl-lg text-xs font-bold uppercase">Popular</div>
                <h3 class="text-2xl font-black text-gray-800 mb-4">Unlimited Access</h3>
                <p class="text-gray-500 mb-6 text-sm">Generate and edit as many as you want.</p>
                
                <div class="space-y-3">
                    <button onclick="pay('R5', 1)" class="w-full flex justify-between p-3 border rounded-xl hover:bg-blue-50 transition">
                        <span>1 Day</span> <span class="font-bold">R5</span>
                    </button>
                    <button onclick="pay('R10', 3)" class="w-full flex justify-between p-3 border rounded-xl hover:bg-blue-50 transition">
                        <span>3 Days</span> <span class="font-bold">R10</span>
                    </button>
                    <button onclick="pay('R20', 15)" class="w-full flex justify-between p-3 border rounded-xl hover:bg-blue-50 transition">
                        <span>15 Days</span> <span class="font-bold">R20</span>
                    </button>
                    <button onclick="pay('R30', 30)" class="w-full flex justify-between p-3 border-2 border-green-500 rounded-xl bg-green-50 font-bold">
                        <span>30 Days</span> <span>R30</span>
                    </button>
                </div>
                <button onclick="pay('R30', 30)" class="w-full mt-6 bg-blue-600 text-white py-3 rounded-xl font-bold shadow-lg hover:bg-blue-700">Unlock Unlimited Now</button>
            </div>

            <div class="bg-white p-8 rounded-2xl shadow-lg border border-gray-200">
                <h3 class="text-2xl font-black text-gray-800 mb-4">Watch & Earn</h3>
                <p class="text-gray-500 mb-6 text-sm">No money? No problem. Watch ads to earn stars.</p>
                
                <div class="bg-orange-50 border border-orange-200 p-4 rounded-xl mb-6">
                    <ul class="text-sm space-y-2 text-orange-800">
                        <li><i class="fas fa-check-circle mr-2"></i> Watch 3 ads for 3 Stars</li>
                        <li><i class="fas fa-check-circle mr-2"></i> 3 Stars = 1 CV & 1 Cover Letter</li>
                        <li><i class="fas fa-check-circle mr-2"></i> Bank stars for future use</li>
                    </ul>
                </div>

                <div id="adProgress" class="hidden mb-4">
                    <p class="text-xs font-bold mb-1 text-orange-600">Ads Watched: <span id="adsCount">0</span>/3</p>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="progressBar" class="bg-orange-500 h-2 rounded-full" style="width: 0%"></div>
                    </div>
                </div>

                <button id="watchAdBtn" onclick="simulateAd()" class="w-full bg-orange-500 text-white py-4 rounded-xl font-bold shadow-lg hover:bg-orange-600 flex flex-col items-center">
                    <span>Watch Ads to Earn Stars</span>
                    <span class="text-xs opacity-80 font-normal">Ads remaining: 3</span>
                </button>
            </div>

        </div>
    </main>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBcp0fkuwhOOyO7fgAlbCoftWwkuog-vwQ",
            authDomain: "quickcv-47c99.firebaseapp.com",
            projectId: "quickcv-47c99",
            storageBucket: "quickcv-47c99.firebasestorage.app",
            messagingSenderId: "541347686112",
            appId: "1:541347686112:web:b821dd7213ab8674959285",
            measurementId: "G-NQ66199Z12"
        };

        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);

        // --- APP LOGIC ---
        let stars = localStorage.getItem('stars') ? parseInt(localStorage.getItem('stars')) : 0;
        let adsWatched = 0;

        const starDisplay = document.getElementById('starCount');
        const watchBtn = document.getElementById('watchAdBtn');
        const adProgressDiv = document.getElementById('adProgress');
        const adsCountSpan = document.getElementById('adsCount');
        const progressBar = document.getElementById('progressBar');

        starDisplay.innerText = stars;

        // RESTORED WATCH & EARN LOGIC
        window.simulateAd = function() {
            adProgressDiv.classList.remove('hidden');
            watchBtn.disabled = true;
            watchBtn.innerText = "Ad Playing...";

            setTimeout(() => {
                adsWatched++;
                adsCountSpan.innerText = adsWatched;
                progressBar.style.width = (adsWatched / 3 * 100) + "%";

                if (adsWatched >= 3) {
                    stars += 3;
                    localStorage.setItem('stars', stars);
                    starDisplay.innerText = stars;
                    adsWatched = 0;
                    alert("Congratulations! You earned 3 Stars.");
                    resetAdUI();
                } else {
                    watchBtn.disabled = false;
                    watchBtn.innerHTML = `<span>Watch Next Ad</span><span class="text-xs opacity-80 font-normal">Ads remaining: ${3 - adsWatched}</span>`;
                }
            }, 3000);
        };

        function resetAdUI() {
            adProgressDiv.classList.add('hidden');
            progressBar.style.width = "0%";
            watchBtn.disabled = false;
            watchBtn.innerHTML = `<span>Watch Ads to Earn Stars</span><span class="text-xs opacity-80 font-normal">Ads remaining: 3</span>`;
        }

        // TRANSACTION LOGIC (PAYSTACK)
        window.pay = function(planName, days) {
            // Convert R price to numerical cents (e.g., "R5" -> 500)
            const price = parseInt(planName.replace('R', '')) * 100;

            let handler = PaystackPop.setup({
                key: 'pk_test_421d171989e8c850ae50df23425b607cae9fe366', 
                email: 'customer@email.com', 
                amount: price,
                currency: 'ZAR',
                metadata: {
                    custom_fields: [{ display_name: "Plan Name", variable_name: "plan", value: planName }]
                },
                callback: function(response){
                    alert('Payment Successful! Reference: ' + response.reference);
                    // Logic to unlock premium for 'days'
                },
                onClose: function(){
                    alert('Transaction cancelled.');
                }
            });
            handler.openIframe();
        }
    </script>
</body>
</html>


