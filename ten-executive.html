<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuickCV | The Executive Workspace</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&family=Playfair+Display:wght@700&display=swap');
        
        body { background-color: #070b14; font-family: 'Plus Jakarta Sans', sans-serif; color: #f8fafc; overflow-x: hidden; }
        .glass-panel { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.05); }
        .executive-blue { background-color: #0a192f; }
        .gold-accent { color: #c5a059; }
        .premium-gradient { background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%); }
        
        /* Access Badge Styles */
        #accessStatus { position: fixed; top: 20px; right: 20px; z-index: 1000; padding: 10px 20px; border-radius: 50px; font-weight: 800; font-size: 12px; text-transform: uppercase; letter-spacing: 1px; }
        .status-denied { background: rgba(239, 68, 68, 0.2); color: #ef4444; border: 1px solid #ef4444; }
        .status-granted { background: rgba(34, 197, 94, 0.2); color: #22c55e; border: 1px solid #22c55e; }

        /* CV Preview Rendering Container (Hidden from view) */
        #cvRenderArea { width: 210mm; background: white; color: #333; position: absolute; left: -9999px; }
        .cv-header { background: #0a192f; color: white; padding: 40px; text-align: center; }
        .cv-name { font-family: 'Playfair Display', serif; font-size: 32pt; letter-spacing: 4px; text-transform: uppercase; }
        .cv-title { color: #c5a059; font-size: 14pt; letter-spacing: 2px; margin-top: 10px; }
        .cv-contact-bar { background: #112240; color: white; padding: 10px; font-size: 9pt; display: flex; justify-content: center; gap: 20px; }

 /* Prevents bullet points or job headers from being cut in half during page breaks */
#pdf-experience > div, #pdf-education > div {
    page-break-inside: avoid;
    break-inside: avoid;
}

    </style>
</head>
<body>

    <div id="accessStatus" class="status-denied">
        <i class="fas fa-lock mr-2"></i> No Access - Pay to Generate
    </div>

    <nav class="max-w-7xl mx-auto p-6 flex justify-between items-center">
        <div class="flex items-center gap-4">
            <a href="ten.html" class="w-10 h-10 rounded-full glass-panel flex items-center justify-center hover:bg-white/10 transition">
                <i class="fas fa-arrow-left text-xs text-slate-400"></i>
            </a>
            <h1 class="text-xl font-black tracking-tighter">QuickCV <span class="text-blue-500">EXECUTIVE</span></h1>
        </div>
        <div id="sessionTimer" class="hidden text-xs font-bold text-emerald-400 bg-emerald-400/10 px-4 py-2 rounded-full border border-emerald-400/20">
            SESSION: 23:59:59 LEFT
        </div>
    </nav>

    <main class="max-w-5xl mx-auto p-6 pb-32">
        
        <section id="step-1" class="mb-12">
            <div class="glass-panel p-8 rounded-[2.5rem] border-blue-500/30">
                <div class="flex flex-col md:flex-row gap-8 items-center">
                    <img src="assets/executive.png" class="w-48 rounded-lg shadow-2xl border border-white/10" alt="Executive Preview">
                    <div>
                        <h2 class="text-3xl font-black mb-2">The Executive</h2>
                        <div class="flex gap-2 mb-4">
                            <span class="bg-blue-500/20 text-blue-400 text-[10px] px-3 py-1 rounded-full font-bold uppercase">Global Corporate Standard</span>
                            <span class="bg-emerald-500/20 text-emerald-400 text-[10px] px-3 py-1 rounded-full font-bold uppercase">ATS Score: 98%</span>
                        </div>
                        <ul class="text-slate-400 text-sm space-y-2 mb-6">
                            <li><i class="fas fa-check-circle text-blue-500 mr-2"></i> Optimized for CEO & C-Suite leadership metrics</li>
                            <li><i class="fas fa-check-circle text-blue-500 mr-2"></i> High-authority typography & layout</li>
                        </ul>
                        <button onclick="document.getElementById('step-2').scrollIntoView({behavior:'smooth'})" class="premium-gradient px-8 py-4 rounded-2xl font-black uppercase text-sm tracking-widest hover:scale-105 transition">
                            Build My Executive CV
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <section id="step-2" class="space-y-6 mb-12">
            <h3 class="text-lg font-black uppercase tracking-widest text-slate-500">The Executive Seal</h3>
            <div class="glass-panel p-8 rounded-[2.5rem] grid md:grid-cols-2 gap-6">
                <div class="space-y-2">
                    <label class="text-[10px] font-bold text-slate-400 uppercase ml-2">Full Name</label>
                    <input type="text" id="fullName" placeholder="MICHAEL ANDERSON" class="w-full bg-white/5 border border-white/10 p-4 rounded-2xl outline-none focus:border-blue-500 text-white font-bold uppercase">
                </div>
                <div class="space-y-2">
                    <label class="text-[10px] font-bold text-slate-400 uppercase ml-2">Professional Title</label>
                    <input type="text" id="jobTitle" placeholder="CHIEF OPERATIONS OFFICER" class="w-full bg-white/5 border border-white/10 p-4 rounded-2xl outline-none focus:border-blue-500 text-white font-bold uppercase">
                </div>
                <div class="space-y-2">
                    <label class="text-[10px] font-bold text-slate-400 uppercase ml-2">Phone Number</label>
                    <input type="text" id="phone" placeholder="+27 82 123 4567" class="w-full bg-white/5 border border-white/10 p-4 rounded-2xl outline-none focus:border-blue-500">
                </div>
                <div class="space-y-2">
                    <label class="text-[10px] font-bold text-slate-400 uppercase ml-2">Email Address</label>
                    <input type="email" id="email" placeholder="michael.anderson@email.com" class="w-full bg-white/5 border border-white/10 p-4 rounded-2xl outline-none focus:border-blue-500">
                </div>
                <div class="space-y-2">
                    <label class="text-[10px] font-bold text-slate-400 uppercase ml-2">LinkedIn URL</label>
                    <input type="text" id="linkedin" placeholder="linkedin.com/in/michael" class="w-full bg-white/5 border border-white/10 p-4 rounded-2xl outline-none focus:border-blue-500">
                </div>
                <div class="space-y-2">
                    <label class="text-[10px] font-bold text-slate-400 uppercase ml-2">City & Country</label>
                    <input type="text" id="location" placeholder="Johannesburg, South Africa" class="w-full bg-white/5 border border-white/10 p-4 rounded-2xl outline-none focus:border-blue-500">
                </div>
            </div>
        </section>

        <section class="space-y-6 mb-12">
            <h3 class="text-lg font-black uppercase tracking-widest text-slate-500">Executive Profile</h3>
            <div class="glass-panel p-8 rounded-[2.5rem]">
                <textarea id="summary" rows="5" placeholder="Accomplished leader with 18+ years of experience driving operational excellence..." class="w-full bg-white/5 border border-white/10 p-6 rounded-2xl outline-none focus:border-blue-500 text-slate-300 leading-relaxed"></textarea>
                <div class="mt-4 flex gap-2">
<button onclick="window.usePowerVerbs()" class="text-[10px] bg-slate-500/10 text-slate-400 px-4 py-2 rounded-full font-bold hover:bg-slate-500/30 transition">USE POWER VERBS</button>

                </div>
            </div>
        </section>

        <section class="space-y-6 mb-12">
            <h3 class="text-lg font-black uppercase tracking-widest text-slate-500">Core Expertise Grid</h3>
            <div class="glass-panel p-8 rounded-[2.5rem]">
                <div id="skillsContainer" class="grid grid-cols-2 md:grid-cols-3 gap-4">
                    </div>
                <div class="mt-6 flex gap-2">
                    <input type="text" id="skillInput" placeholder="Add Skill (e.g., P&L Management)" class="flex-1 bg-white/5 border border-white/10 p-4 rounded-2xl outline-none focus:border-blue-500">
                    <button onclick="addSkill()" class="bg-blue-600 text-white px-8 rounded-2xl font-bold">ADD</button>
                </div>
            </div>
        </section>

        <section class="space-y-6 mb-12">
            <div class="flex justify-between items-center">
                <h3 class="text-lg font-black uppercase tracking-widest text-slate-500">Result-Driven Experience</h3>
                <button onclick="addExperience()" class="bg-blue-600/10 text-blue-400 text-xs font-black px-4 py-2 rounded-xl border border-blue-600/20">+ ADD ROLE</button>
            </div>
            <div id="experienceList" class="space-y-6">
                </div>
        </section>

        <section class="space-y-6 mb-12">
    <div class="flex justify-between items-center">
        <h3 class="text-lg font-black uppercase tracking-widest text-slate-500">Education & Trust Signals</h3>
        <button onclick="addEducation()" class="bg-blue-600/10 text-blue-400 text-xs font-black px-4 py-2 rounded-xl border border-blue-600/20">+ ADD EDUCATION</button>
    </div>
    <div id="educationList" class="space-y-6">
        </div>

    <div class="glass-panel p-8 rounded-[2.5rem] mt-6">
        <label class="text-[10px] font-bold text-slate-400 uppercase mb-4 block">Executive Credentials</label>
        <div id="certGrid" class="grid grid-cols-2 md:grid-cols-3 gap-4">
            <label class="flex items-center gap-3 bg-white/5 p-4 rounded-xl border border-white/10 cursor-pointer hover:bg-white/10 transition">
                <input type="checkbox" value="MBA" class="cert-check w-4 h-4 accent-blue-500">
                <span class="text-xs font-bold">MBA</span>
            </label>
            <label class="flex items-center gap-3 bg-white/5 p-4 rounded-xl border border-white/10 cursor-pointer hover:bg-white/10 transition">
                <input type="checkbox" value="PMP" class="cert-check w-4 h-4 accent-blue-500">
                <span class="text-xs font-bold">PMPÂ®</span>
            </label>
            <label class="flex items-center gap-3 bg-white/5 p-4 rounded-xl border border-white/10 cursor-pointer hover:bg-white/10 transition">
                <input type="checkbox" value="CA(SA)" class="cert-check w-4 h-4 accent-blue-500">
                <span class="text-xs font-bold">CA(SA)</span>
            </label>
            <label class="flex items-center gap-3 bg-white/5 p-4 rounded-xl border border-white/10 cursor-pointer hover:bg-white/10 transition">
                <input type="checkbox" value="CFA" class="cert-check w-4 h-4 accent-blue-500">
                <span class="text-xs font-bold">CFAÂ®</span>
            </label>
            <label class="flex items-center gap-3 bg-white/5 p-4 rounded-xl border border-white/10 cursor-pointer hover:bg-white/10 transition">
                <input type="checkbox" value="Lean Six Sigma" class="cert-check w-4 h-4 accent-blue-500">
                <span class="text-xs font-bold">Lean Six Sigma</span>
            </label>
            <label class="flex items-center gap-3 bg-white/5 p-4 rounded-xl border border-white/10 cursor-pointer hover:bg-white/10 transition">
                <input type="checkbox" value="ITIL" class="cert-check w-4 h-4 accent-blue-500">
                <span class="text-xs font-bold">ITILÂ®</span>
            </label>
        </div>
        <div class="mt-4 flex gap-2">
    <input type="text" id="customCertInput" placeholder="Add custom (e.g. Board Member, IoDSA)" 
           class="flex-1 bg-white/5 border border-white/10 p-4 rounded-xl text-xs outline-none focus:border-blue-500 text-white">
    <button onclick="addCustomCert()" class="bg-slate-700 text-white px-6 rounded-xl text-[10px] font-bold">ADD</button>
</div>
<div id="customCertList" class="flex flex-wrap gap-2 mt-3"></div>

    </div>
</section>

        
        <div class="fixed bottom-0 left-0 w-full glass-panel p-6 z-[50] flex gap-4 justify-center">
            <button onclick="validateAndGenerate()" class="premium-gradient px-12 py-5 rounded-2xl font-black uppercase text-sm tracking-[2px] shadow-2xl hover:scale-105 active:scale-95 transition-all">
                <i class="fas fa-file-pdf mr-2"></i> Generate Executive CV
            </button>
        </div>

    </main>

    <div id="cvRenderArea">
        <div class="cv-header">
            <div id="pdf-name" class="cv-name">MICHAEL ANDERSON</div>
            <div id="pdf-title" class="cv-title">CHIEF OPERATIONS OFFICER</div>
        </div>
        <div id="pdf-contact" class="cv-contact-bar">
            <span>+27 82 123 4567</span> | <span>michael@email.com</span> | <span>linkedin/michael</span>
        </div>
        <div style="padding: 40px; font-size: 10pt; line-height: 1.6;">
            <div style="text-align:center; font-weight:800; border-bottom: 1px solid #ddd; margin-bottom: 10px; padding-bottom: 5px;">EXECUTIVE PROFILE</div>
            <p id="pdf-summary" style="margin-bottom: 25px;"></p>

            <div style="text-align:center; font-weight:800; border-bottom: 1px solid #ddd; margin-bottom: 15px; padding-bottom: 5px;">CORE COMPETENCIES</div>
            <div id="pdf-skills" style="display: grid; grid-template-columns: 1fr 1fr 1fr; margin-bottom: 25px; gap: 5px;"></div>

            <div style="text-align:center; font-weight:800; border-bottom: 1px solid #ddd; margin-bottom: 15px; padding-bottom: 5px;">PROFESSIONAL EXPERIENCE</div>
            <div id="pdf-experience"></div> </div>
        <div style="text-align:center; font-weight:800; border-bottom: 1px solid #ddd; margin-bottom: 15px; padding-bottom: 5px; margin-top: 20px;">EDUCATION & CREDENTIALS</div>
      <div id="pdf-education" style="margin-bottom: 15px;"></div>
    <div id="pdf-certs" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-weight: 700; font-size: 9pt;"></div>

        
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // CONFIG (Replace with yours)
        const firebaseConfig = {
            apiKey: "AIzaSyBcp0fkuwhOOyO7fgAlbCoftWwkuog-vwQ",
            authDomain: "quickcv-47c99.firebaseapp.com",
            projectId: "quickcv-47c99",
            storageBucket: "quickcv-47c99.firebasestorage.app",
            messagingSenderId: "541347686112",
            appId: "1:541347686112:web:b821dd7213ab8674959285"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let userHasAccess = false;
        let timeLeftInterval;

        onAuthStateChanged(auth, async (user) => {
            if (!user) {
                window.location.href = 'index.html';
                return;
            }
            checkAccess(user);
        });

        async function checkAccess(user) {
            const userRef = doc(db, "users", user.uid);
            const userSnap = await getDoc(userRef);

            if (userSnap.exists() && userSnap.data().expiryDate) {
                const expiry = userSnap.data().expiryDate.toDate();
                const now = new Date();

                if (expiry > now) {
                    grantAccess(expiry);
                } else {
                    denyAccess();
                }
            } else {
                denyAccess();
            }
        }

        function grantAccess(expiry) {
            userHasAccess = true;
            const badge = document.getElementById('accessStatus');
            badge.className = "status-granted";
            badge.innerHTML = '<i class="fas fa-check-circle mr-2"></i> 1-Day Access Active';
            
            document.getElementById('sessionTimer').classList.remove('hidden');
            startTimer(expiry);
        }

        function denyAccess() {
            userHasAccess = false;
            const badge = document.getElementById('accessStatus');
            badge.className = "status-denied";
            badge.innerHTML = '<i class="fas fa-lock mr-2"></i> Access Denied - Pay R10';
        }

        function startTimer(expiry) {
            timeLeftInterval = setInterval(() => {
                const now = new Date().getTime();
                const distance = expiry.getTime() - now;

                if (distance < 0) {
                    clearInterval(timeLeftInterval);
                    denyAccess();
                    return;
                }

                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);

                document.getElementById('sessionTimer').innerText = 
                    `SESSION: ${String(hours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')} LEFT`;
            }, 1000);
        }

        // --- DYNAMIC FORM HANDLERS ---
        window.skills = ["P&L Management", "Strategic Planning", "Change Management", "Risk Governance", "Mergers & Acquisitions", "Operational Excellence"];
        
        window.renderSkills = () => {
            const container = document.getElementById('skillsContainer');
            container.innerHTML = window.skills.map((s, i) => `
                <div class="bg-white/5 border border-white/10 p-4 rounded-xl flex justify-between items-center group">
                    <span class="text-xs font-bold text-slate-300">â€¢ ${s}</span>
                    <i class="fas fa-times text-red-500 cursor-pointer opacity-0 group-hover:opacity-100 transition" onclick="removeSkill(${i})"></i>
                </div>
            `).join('');
        };

        window.addSkill = () => {
            const val = document.getElementById('skillInput').value;
            if(val) { window.skills.push(val); document.getElementById('skillInput').value = ""; renderSkills(); }
        };

        window.removeSkill = (i) => { window.skills.splice(i, 1); renderSkills(); };

        window.addExperience = () => {
            const id = Date.now();
            const html = `
                <div id="exp-${id}" class="glass-panel p-8 rounded-[2.5rem] relative">
                    <button onclick="this.parentElement.remove()" class="absolute top-6 right-6 text-red-500 hover:scale-110"><i class="fas fa-trash"></i></button>
                    <div class="grid md:grid-cols-2 gap-4 mb-4">
                        <input type="text" placeholder="Company Name" class="exp-company bg-white/5 border border-white/10 p-4 rounded-xl text-sm font-bold">
                        <input type="text" placeholder="Job Title" class="exp-role bg-white/5 border border-white/10 p-4 rounded-xl text-sm font-bold">
                        <input type="text" placeholder="Duration (e.g. 2018 - Present)" class="exp-date bg-white/5 border border-white/10 p-4 rounded-xl text-xs">
                        <input type="text" placeholder="Context (e.g. R1.2B annual revenue)" class="exp-context bg-white/5 border border-white/10 p-4 rounded-xl text-xs">
                    </div>
                    <textarea placeholder="Achievements (Bullet points)..." class="exp-bullets w-full bg-white/5 border border-white/10 p-4 rounded-xl text-xs h-32"></textarea>
                </div>
            `;
            document.getElementById('experienceList').insertAdjacentHTML('beforeend', html);
        };

        
        window.addEducation = () => {
    const id = Date.now();
    const html = `
        <div id="edu-${id}" class="glass-panel p-8 rounded-[2.5rem] relative">
            <button onclick="this.parentElement.remove()" class="absolute top-6 right-6 text-red-500 hover:scale-110"><i class="fas fa-trash"></i></button>
            <div class="grid md:grid-cols-2 gap-4">
                <input type="text" placeholder="Degree (e.g. Bachelor of Commerce)" class="edu-degree bg-white/5 border border-white/10 p-4 rounded-xl text-sm font-bold">
                <input type="text" placeholder="Institution (e.g. University of Cape Town)" class="edu-school bg-white/5 border border-white/10 p-4 rounded-xl text-sm font-bold">
                <input type="text" placeholder="Field of Study" class="edu-field bg-white/5 border border-white/10 p-4 rounded-xl text-xs">
                <input type="text" placeholder="Graduation Year (Optional)" class="edu-year bg-white/5 border border-white/10 p-4 rounded-xl text-xs">
            </div>
        </div>
    `;
    document.getElementById('educationList').insertAdjacentHTML('beforeend', html);
};

        window.customCerts = [];

window.addCustomCert = () => {
    const val = document.getElementById('customCertInput').value;
    if(val) {
        window.customCerts.push(val);
        document.getElementById('customCertInput').value = "";
        renderCustomCerts();
    }
};

window.renderCustomCerts = () => {
    const container = document.getElementById('customCertList');
    container.innerHTML = window.customCerts.map((c, i) => `
        <span class="bg-blue-500/10 text-blue-400 border border-blue-500/20 px-3 py-1 rounded-full text-[10px] font-bold flex items-center gap-2">
            ${c} <i class="fas fa-times cursor-pointer" onclick="window.customCerts.splice(${i},1); renderCustomCerts();"></i>
        </span>
    `).join('');
};


        // --- GENERATION ENGINE ---
        window.validateAndGenerate = async () => {
            if (!userHasAccess) {
                alert("Redirecting to payment page...");
                window.location.href = "ten-pay.html";
                return;
            }

            // Map UI to PDF Preview
            document.getElementById('pdf-name').innerText = document.getElementById('fullName').value || "MICHAEL ANDERSON";
            document.getElementById('pdf-title').innerText = document.getElementById('jobTitle').value || "CHIEF OPERATIONS OFFICER";
            document.getElementById('pdf-contact').innerHTML = `
                <span>${document.getElementById('phone').value}</span> | 
                <span>${document.getElementById('email').value}</span> | 
                <span>${document.getElementById('linkedin').value}</span> | 
                <span>${document.getElementById('location').value}</span>
            `;
            document.getElementById('pdf-summary').innerText = document.getElementById('summary').value;
            
            // Map Skills
            document.getElementById('pdf-skills').innerHTML = window.skills.map(s => `<div>â€¢ ${s}</div>`).join('');

            // Map Experience
            let expHtml = "";
            document.querySelectorAll('#experienceList > div').forEach(card => {
                expHtml += `
                    <div style="margin-bottom: 20px;">
                        <div style="display:flex; justify-content:space-between; font-weight:800;">
                            <span>${card.querySelector('.exp-company').value} | ${card.querySelector('.exp-date').value}</span>
                        </div>
                        <div style="font-style:italic; font-weight:700;">${card.querySelector('.exp-role').value}</div>
                        <div style="font-size:8pt; color:#666; margin-bottom:5px;">${card.querySelector('.exp-context').value}</div>
                        <div style="font-size:9pt;">${card.querySelector('.exp-bullets').value.split('\n').map(b => `<div>â€¢ ${b}</div>`).join('')}</div>
                    </div>
                `;
            });
            document.getElementById('pdf-experience').innerHTML = expHtml;

            // Map Education
let eduHtml = "";
document.querySelectorAll('#educationList > div').forEach(card => {
    eduHtml += `
        <div style="margin-bottom: 10px;">
            <div style="display:flex; justify-content:space-between; font-weight:800;">
                <span>${card.querySelector('.edu-degree').value}</span>
                <span>${card.querySelector('.edu-year').value}</span>
            </div>
            <div style="font-size:9pt;">${card.querySelector('.edu-school').value} | ${card.querySelector('.edu-field').value}</div>
        </div>
    `;
});
document.getElementById('pdf-education').innerHTML = eduHtml;

// Map Selected Certifications
let selectedCerts = [];
document.querySelectorAll('.cert-check:checked').forEach(box => {
    selectedCerts.push(`[ ${box.value} ]`);
});
document.getElementById('pdf-certs').innerHTML = selectedCerts.map(c => `<div>${c}</div>`).join('');

 // Combine checkboxes and custom entries
let allCerts = [];
document.querySelectorAll('.cert-check:checked').forEach(box => allCerts.push(`[ ${box.value} ]`));
window.customCerts.forEach(c => allCerts.push(`[ ${c.toUpperCase()} ]`));

document.getElementById('pdf-certs').innerHTML = allCerts.map(c => `<div>${c}</div>`).join('');


            // Render PDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('p', 'mm', 'a4');
            const element = document.getElementById('cvRenderArea');

            // Capture as image for exact photo-matching
            const canvas = await html2canvas(element, { scale: 3, useCORS: true });
            const imgData = canvas.toDataURL('image/png');
            
            const imgProps = doc.getImageProperties(imgData);
            const pdfWidth = doc.internal.pageSize.getWidth();
            const pdfHeight = (imgProps.height * pdfWidth) / imgProps.width;

            doc.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
            
            // Check if page 1 is too long and handle overflow
            if (pdfHeight > 297) {
                let remainingHeight = pdfHeight;
                let position = 0;
                while (remainingHeight > 0) {
                    position -= 297;
                    remainingHeight -= 297;
                    if (remainingHeight > 0) {
                        doc.addPage();
                        doc.addImage(imgData, 'PNG', 0, position, pdfWidth, pdfHeight);
                    }
                }
            }

            const fileName = `${document.getElementById('fullName').value || 'Executive'}_CV.pdf`;
            doc.save(fileName);

            // POST GENERATION
            if (confirm("CV Generated! Would you like a matching Executive Cover Letter?")) {
                window.location.href = "ten-excutive-2.html";
            } else {
                window.location.href = "ten.html";
            }
        };



window.usePowerVerbs = () => {
    let text = document.getElementById('summary').value;
    if(!text) {
        alert("Please write something first!");
        return;
    };

    const powerMap = {
        // LEADERSHIP & PEOPLE
        "led": "spearheaded", "lead": "spearhead",
        "managed": "orchestrated", "manage": "orchestrate",
        "bossed": "directed", "supervised": "governed",
        "helped": "facilitated", "help": "empower",
        "trained": "mentored", "train": "mentor",
        "hired": "recruited", "hire": "recruit",
        "fired": "restructured", "working": "collaborating",
        "watched": "monitored", "watch": "monitor",
        "team": "cross-functional unit", "people": "human capital",

        // GROWTH, REVENUE & FINANCE
        "grew": "exponentially expanded", "grow": "cultivate",
        "increased": "maximized", "increase": "maximize",
        "saved": "conserved", "save": "conserve",
        "won": "secured", "win": "secure",
        "improved": "optimized", "improve": "optimize",
        "spent": "allocated", "spend": "allocate",
        "bought": "procured", "buy": "procure",
        "sold": "monetized", "sell": "monetize",
        "got": "acquired", "get": "acquire",
        "money": "capital", "profit": "bottom-line earnings",

        // STRATEGY & INNOVATION
        "started": "pioneered", "start": "initiate",
        "made": "engineered", "make": "formulate",
        "built": "constructed", "build": "construct",
        "created": "authored", "create": "generate",
        "thought": "conceptualized", "think": "envision",
        "planned": "strategized", "plan": "strategize",
        "changed": "transformed", "change": "transform",
        "found": "identified", "find": "identify",
        "idea": "strategic initiative", "new": "innovative",

        // EXECUTION & OPERATIONS
        "did": "executed", "do": "implement",
        "worked": "navigated", "work": "function",
        "used": "leveraged", "use": "leverage",
        "fixed": "rectified", "fix": "rectify",
        "handled": "mitigated", "handle": "address",
        "kept": "sustained", "keep": "sustain",
        "met": "surpassed", "meet": "exceed",
        "finished": "finalized", "finish": "conclude",
        "organized": "systematized", "organize": "coordinate",
        "checked": "audited", "check": "verify",
        "job": "mandate", "task": "objective",

        // COMMUNICATION & AUTHORITY
        "said": "articulated", "say": "articulate",
        "wrote": "composed", "write": "author",
        "showed": "demonstrated", "show": "demonstrate",
        "talked": "negotiated", "talk": "negotiate",
        "shared": "disseminated", "share": "disseminate",
        "asked": "queried", "ask": "query",
        "gave": "presented", "give": "present",
        "explained": "clarified", "explain": "elucidate",

        // EXECUTIVE ADJECTIVES & FILLERS
        "good": "exceptional", "better": "superior",
        "big": "substantial", "small": "targeted",
        "fast": "expedited", "quick": "agile",
        "hard": "rigorous", "easy": "seamless",
        "many": "numerous", "some": "diverse",
        "a lot": "a significant volume of", "really": "decidedly",
        "successful": "high-impact", "best": "industry-leading"
    };

    let count = 0;
    Object.keys(powerMap).forEach(key => {
        // \b ensures we don't replace parts of words (e.g., 'manage' in 'management')
        const regex = new RegExp(`\\b${key}\\b`, "gi");
        const matches = text.match(regex);
        
        if(matches) {
            text = text.replace(regex, (matched) => {
                // Preserve Capitalization (e.g., 'Led' becomes 'Spearheaded')
                if (matched[0] === matched[0].toUpperCase()) {
                    const replacement = powerMap[key];
                    return replacement.charAt(0).toUpperCase() + replacement.slice(1);
                }
                return powerMap[key];
            });
            count += matches.length;
        }
    });

    if(count > 0) {
        document.getElementById('summary').value = text;
        const btn = event.target;
        const originalText = btn.innerText;
        
        btn.innerText = `ðŸš€ ${count} EXECUTIVE UPGRADES`;
        btn.style.background = "#22c55e"; 
        btn.style.color = "white";
        
        setTimeout(() => {
            btn.innerText = originalText;
            btn.style.background = "";
            btn.style.color = "";
        }, 3000);
    } else {
        alert("Your profile already utilizes high-authority language. No weak verbs detected!");
    }
};



// Initialize
renderSkills();
addExperience();
addEducation(); // Add a blank education field by default

        
        
    </script>
</body>
</html>

